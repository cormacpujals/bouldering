<%- include('../partials/header') %>

<h2>Look at this cool post.</h2>

<table id="list">
    <thead>
    <tr>
        <th>Name</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td><%= post.name %></td>
        <% if (user) { %>
            <form action="/posts/<%= post._id %>?_method=DELETE" method="POST">
                <button type="submit">DELETE BOULDER</button>
            </form>
            <a href="/posts/<%= post._id %>/edit">Edit Boulder</a>
        <% } else { %>
        <% } %>
        </tr>
    </tbody>
</table>

<br><br><h2>Comments</h2>



<% if (user) { %>
<form id="add-comment-form" method="POST"
      action="/posts/<%= post._id %>/comments">
    <label>Comments:</label>
    <textarea name="content"></textarea>
    <input type="submit" value="Add Comment">
</form>
<% } %>


<% if (post.comments.length) { %>
    <table>
        <thead>
        <tr>
            <th>User</th>
            <th>Date</th>
            <th>Comment</th>
        </tr>
        </thead>
        <tbody>
        <% post.comments.forEach(function(c) { %>
            <tr>
                <td class="comments-user"><img alt="avatar" src="<%= c.userAvatar %>" referrerpolicy="no-referrer"> <%= c.userName %></td>
                <td><%= c.createdAt.toLocaleDateString() %></td>
                <td><%= c.content %></td>
                <td>
                    <% if (user?._id.equals(c.user)) { %>
                        <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                            <button type="submit">X</button>
                        </form>
                    <% } %>
                </td>
            </tr>
        <% }); %>
        </tbody>
    </table>
<% } else { %>
    <h5>No Comments Yet</h5>
<% } %>

<%- include('../partials/footer') %>
